<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">

    <title>Vue Test Area</title>
    <link rel="stylesheet" href="site.css">
    <style>
        .main {
            display: flex;
            flex: auto;
            font-size: 1.2rem;
            justify-content: flex-start;
            align-items: center;
            padding: 16px;
        }
        .links {
            max-width: 600px;
            padding: 32px;
            grid-template-columns: 1fr;   
        }
        .filterOption {
            min-width: 150px;
            border-top: solid 2px #c2c2c2;
            padding-bottom: 16px;
        }
        .filterOption .filterTitle {
            display: grid;
            grid-template-columns: 1fr 0.2fr;
            gap: 16px;
            
        }
        .filterOption .filterOptionList {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            padding: 8px;
        }
        .filterGroups {
            padding: 16px;
            border-radius: 8px;
            background-color: #e8e8e8;    
        }

        @media(max-width:600px)
        {
            .filterGroups {
                position: absolute;
                top: 0px;
                left: 0px;
                height: 100%;
                animation: appear 0.5s;
        |   }
            .filterGroups.hide {
                animation: disapear 0.5s;
                animation-fill-mode:forwards;
            }
            @keyframes appear {
               0%{
                   transform: translateX(-100%);
               }
                
                100% {
                    transform: translateX(0%); 
                }    
            }
            @keyframes disapear {
                0% {
                    transform: translateX(0%);
                }
                100% {
                    transform: translateX(-100%); 
                }    
            }

            button.filter {
                display: block;
            }
        }
        @media(min-width: 600px){
            button.filter {
                display: none;
            }
            .layout {
                display: grid;
                gap: 16px;
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="main" id="app">
        <div class="layout">
            
            <div class="filterGroups" v-bind:class="{ hide: !showingFilters }">
            
                <filter-options title="Frame Colors" :options="filter1_options"></filter-options>
                <filter-options title="Frame Materials" :options="filter2_options"></filter-options>
                <filter-options title="Brands" :options="filter3_options"></filter-options>

                <button class="filter" v-on:click="showFilters">Apply</button>
            </div>

            <div>
                <button class="filter" v-on:click="showFilters">Filter</button>
                <div>
                    Selected Colors
                    <ul v-for="item in filter1_options.selected">
                        <li>{{ item }}</li>
                    </ul>
                </div>
                <div>
                    Selected Materials
                    <ul v-for="item in filter2_options.selected">
                        <li>{{ item }}</li>
                    </ul>
                </div>
                <div>
                    Selected Brands
                    <ul v-for="item in filter3_options.selected">
                        <li>{{ item }}</li>
                    </ul>
                </div>
            </div>
            
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/vue@next"></script>

    <script type="text/javascript">
/*
Filter Options component needs
pass in array of options
*/

        class FilterOptionsType
        {
            constructor(items, selected){
                this.items = items;
                this.selected = selected;
            }
            clear(){
                this.items = [];
                this.selected = [];
            }
        }

        const FilterOptions = {
            template: `
                <div class="filterOption">
                    <div class="filterTitle" role="filter" v-on:click="toggleShowOptions()">
                        <div>{{ title }}</div>
                        <div aria-label="">{{ this.showOptions ? "-" : "+" }}</div>
                    </div>
                    <div class="filterOptionList" v-if="showOptions">
                        <div v-for="item in options.items">
                            <label role="option"><input type="checkbox" role="checkbox" aria-checked="false" v-model="options.selected" :value="item.value" /> {{ item.title }}</label>
                        </div>
                    </div>
                    
                </div>
            `,
            props: {
                title : {
                    required: true,
                    type: String,
                    default: ""
                },
                options: {
                    type: FilterOptionsType,
                    required: true
                }
            },
            data() {
                return {
                    showOptions: {
                        required: false,
                        type: Boolean,
                        default: false
                    }
                }
            },
            methods: {
                toggleShowOptions(){
                    console.log("toggleShowOptions");
                    this.showOptions = !this.showOptions;
                }
            }
        }

        const App = {
            data(){
                return {
                    links:[],
                    filter1: "Joe mama",
                    filter1_options: {
                        type: FilterOptionsType,
                        default: new FilterOptionsType([],[])
                    },
                    filter2_options: {
                        type: FilterOptionsType,
                        default: new FilterOptionsType([],[])
                    },
                    filter3_options: {
                        type: FilterOptionsType,
                        default: new FilterOptionsType([],[])
                    },
                    showingFilters :{
                        type: Boolean,
                        default: false
                    }
                }
            },
            components: {
                "filter-options": FilterOptions
            },
            methods: {
                showFilters(){
                    this.showingFilters = !this.showingFilters;
                }
            },
            watch: {
                "filter1_options.selected" : function(newVal, oldVal){
                    console.log(`Filter1 New value: ${newVal} Old Value: ${oldVal}`);
                    // clear out the second filter
                    //this.filter2_options.items = [];
                    // if (this.filter2_options != undefined){
                    //     this.filter2_options.items.pop();
                    // }
                    // var self = this;
                    // setTimeout(function(){
                    //     self.filter2_options.items = [{title:"Metal", value: 10 }, {title: "Plastic", value: 20 }, {title: "Other", value: 30}];
                    // }, 2000);
                    
                },
                "filter2_options.selected" : function(newVal, oldVal){
                    console.log(`Filter2 New value: ${newVal} Old Value: ${oldVal}`);
                }
            },
            mounted() {
                console.log("mounted");
                var self = this;
                setTimeout(function(){
                    self.filter1 = "I'm late";
                    console.log(self.filter1);
                    self.filter1_options = new FilterOptionsType([{title:"Red", value: 1 }, {title: "Green", value: 2 }], [1]);
                    self.filter2_options = new FilterOptionsType([{title:"Metal", value: 10 }, {title: "Plastic", value: 20 }], [10,20]);
                    self.filter3_options = new FilterOptionsType([{title:"Nike", value: 100 }, {title: "Flexon", value: 200 }], []);
                }, 1000)
            }
        }
        const app = Vue.createApp(App);
         
        app.mount('#app');

    </script>
</body>
</html>